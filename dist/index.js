module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=14)}([function(e,t){e.exports=require("lodash")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MR_PR_DADDY_ONE_CHILD="Mr PR Daddy with One Child",e.MR_PR_DADDY_PERFECT="Mr PR Daddy Perfect",e.MR_SG_DADDY_CHILD_IS_OLD="Mr SG with 1 old child",e.MR_SG_DADDY_CHILD_NONE="Mr SG with no children",e.MR_SG_DADDY_LONG_NAMES="Mr SG daddy with long names",e.MR_SG_DADDY_MANY_CHILDREN="Mr SG with many children",e.MR_SG_DADDY_MISSING_FIELDS="Mr SG Daddy Missing Fields",e.MR_SG_DADDY_MISSING_UNEDITABLE_FIELDS="Mr SG Daddy Missing Uneditable Fields",e.MR_SG_DADDY_PERFECT="Mr SG Daddy Perfect",e.MR_SG_PRESCHOOL_CHILDREN="Mr SG Preschool Children",e.MRS_MY_MOMMY_PERFECT="Mrs MY Mommy Perfect",e.MRS_SG_MOMMY_PERFECT="Mrs SG Mommy Perfect",e.MR_MY_DADDY_PERFECT="Mr MY Daddy Perfect"}(t.ProfileArchetype||(t.ProfileArchetype={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1).ProfileArchetype.MR_SG_DADDY_PERFECT;t.mrSGDaddyPerfect={id:"S8399420G",name:i,generate:function(e){return e=n.isEmpty(e)?i:e,{edulevel:{lastupdated:"2018-05-10",code:"8",source:"2",classification:"C",desc:"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)"},dialect:{lastupdated:"2018-06-01",code:"HK",source:"1",classification:"C",desc:"HOKKIEN"},occupation:{lastupdated:"2018-05-21",code:"11110",source:"2",classification:"C",desc:"LEGISLATOR"},regadd:{country:{code:"SG",desc:"SINGAPORE"},unit:{value:"22"},street:{value:"TOA PAYOH LORONG 1"},lastupdated:"2018-05-10",block:{value:"123"},postal:{value:"310123"},source:"1",classification:"C",floor:{value:"12"},type:"SG",building:{value:""}},mobileno:{lastupdated:"2019-04-03",source:"4",classification:"C",areacode:{value:"65"},prefix:{value:"+"},nbr:{value:"97399245"}},passportexpirydate:{lastupdated:"",source:"1",classification:"C",value:""},divorcedate:{lastupdated:"",source:"1",classification:"C",value:""},marriagecertno:{lastupdated:"2018-05-10",source:"1",classification:"C",value:"M525997"},merdekagen:{eligibility:{value:!0},lastupdated:"2019-04-01",quantum:{value:200},source:"1",classification:"C",message:{code:2,desc:"You are eligible for the Merdeka Generation Package. For further enquiries, please contact 1800-2222-888."}},gstvoucher:{gstregular:{value:300},year:{value:2018},exclusion:{value:!1},gstmedisave:{value:250},lastupdated:"2019-04-01",gstspecial:{value:55},source:"1",classification:"C",signup:{value:!0}},email:{lastupdated:"2019-04-03",source:"4",classification:"C",value:"myinfotesting@gmail.com"},birthcountry:{lastupdated:"2018-06-01",code:"SG",source:"1",classification:"C",desc:"SINGAPORE"},race:{lastupdated:"2018-06-01",code:"CN",source:"1",classification:"C",desc:"CHINESE"},silversupport:{eligibility:{value:!0},lastupdated:"2019-04-01",amount:{value:300},source:"1",classification:"C",year:{value:2019}},countryofmarriage:{lastupdated:"2018-05-10",code:"SG",source:"1",classification:"C",desc:"SINGAPORE"},sex:{lastupdated:"2018-06-01",code:"M",source:"1",classification:"C",desc:"Male"},marriagedate:{lastupdated:"1993-10-22",source:"1",classification:"C",value:"1993-10-22"},residentialstatus:{lastupdated:"2018-06-01",code:"C",source:"1",classification:"C",desc:"Citizen"},passportnumber:{lastupdated:"",source:"1",classification:"C",value:""},marital:{lastupdated:"2018-05-10",code:"2",source:"1",classification:"C",desc:"MARRIED"},aliasname:{lastupdated:"2018-06-01",source:"1",classification:"C",value:"JASCKSON LIM YONG XIANG"},childrenbirthrecords:[{dialect:{code:"HK",desc:"Hokkien"},race:{code:"CN",desc:"Chinese"},lifestatus:{code:"A",desc:"ALIVE"},tob:{value:"0901"},sex:{code:"F",desc:"Female"},source:"1",classification:"C",birthcertno:{value:"S5562882C"},hanyupinyinname:{value:"Cheng Pei Ni"},hanyupinyinaliasname:{value:""},marriedname:{value:""},aliasname:{value:""},dob:{value:"2011-09-10"},name:{value:"Jo Tan Pei Ni"},lastupdated:"2018-05-16",secondaryrace:{code:"",desc:""}}],nationality:{lastupdated:"2018-06-01",code:"SG",source:"1",classification:"C",desc:"SINGAPORE CITIZEN"},dob:{lastupdated:"2018-06-01",source:"1",classification:"C",value:"1953-10-06"},name:{lastupdated:"2018-06-01",source:"1",classification:"C",value:"LIM YONG XIANG"},secondaryrace:{lastupdated:"2018-06-01",code:"GM",source:"1",classification:"C",desc:"GERMAN"}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);function i(e){return{codeToDesc:e,descToCode:n.invert(e)}}!function(e){e.map=i({F:"Female",M:"Male",U:"Unknown"})}(t.sex||(t.sex={})),function(e){e.map=i({Y:"Eligible",N:"Not Eligible"})}(t.comstatus||(t.comstatus={})),function(e){e.map=i({A:"ALIVE",D:"DECEASED"})}(t.lifestatus||(t.lifestatus={})),function(e){e.map=i({V:"Valid",E:"Expired",I:"Invalid",N:"Not Holding PDL"})}(t.validity||(t.validity={})),function(e){e.map=i({111:"1-ROOM FLAT (HDB)",112:"2-ROOM FLAT (HDB)",113:"3-ROOM FLAT (HDB)",114:"4-ROOM FLAT (HDB)",115:"5-ROOM FLAT (HDB)",116:"EXECUTIVE FLAT (HDB)",118:"STUDIO APARTMENT (HDB)"})}(t.hdbtype||(t.hdbtype={})),function(e){e.map=i({A:"Alien",C:"Citizen",P:"PR",U:"Unknown",N:"NOT APPLICABLE"})}(t.residentialstatus||(t.residentialstatus={})),function(e){e.map=i({121:"DETACHED HOUSE",122:"SEMI-DETACHED HOUSE",123:"TERRACE HOUSE",131:"CONDOMINIUM",132:"EXECUTIVE CONDOMINIUM",139:"APARTMENT"})}(t.housingtype||(t.housingtype={})),function(e){e.map=i({1:"SINGLE",2:"MARRIED",3:"WIDOWED",5:"DIVORCED"})}(t.marital||(t.marital={})),function(e){e.map=i({0:"NO FORMAL QUALIFICATION / PRE-PRIMARY / LOWER PRIMARY",1:"PRIMARY",2:"LOWER SECONDARY",3:"SECONDARY",4:"POST-SECONDARY (NON-TERTIARY): GENERAL & VOCATION",5:"POLYTECHNIC DIPLOMA",6:"PROFESSIONAL QUALIFICATION AND OTHER DIPLOMA",7:"BACHELOR'S OR EQUIVALENT",8:"POSTGRADUATE DIPLOMA / CERTIFICATE (EXCLUDING MASTER'S AND DOCTORATE)",9:"MASTER'S AND DOCTORATE OR EQUIVALENT",N:"MODULAR CERTIFICATION (NON-AWARD COURSES / NON-FULL QUALIFICATIONS)"})}(t.edulevel||(t.edulevel={})),function(e){e.map={codeToDesc:{RPass:"Work Permit",SPass:"S Pass",P1Pass:"Employment Pass",P2Pass:"Employment Pass",QPass:"Employment Pass",PEP:"Personalised Employment Pass",WHP:"Work Holiday Pass",TEP:"Training Employment Pass",Entre:"EntrePass",DP:"Dependent Pass",LTVP:"Long Term Visit Pass",LOC:"Letter of Consent",MWP:"Miscellaneous Work Pass"}}}(t.passtype||(t.passtype={})),function(e){e.map=i({1:"LIVE",2:"DE-REGISTERED"})}(t.status||(t.status={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=function(e){return e?e.format("YYYY-MM-DD").toString():n().format("YYYY-MM-DD").toString()},a={birthcertno:{value:"T1828432J"},name:{value:"Youngest Tan Ke Xuan"},dob:{value:i()}},o={birthcertno:{value:"T4383608G"},name:{value:"1 Month Tan Ke Yu"},dob:{value:i(n().subtract(1,"months"))}},s={birthcertno:{value:"T7153144E"},name:{value:"2 Months Tan Keh Guan"},dob:{value:i(n().subtract(2,"months"))}},u={birthcertno:{value:"T1694727F"},name:{value:"Middle Tan Twin1"},dob:{value:i(n().subtract(2,"years"))}},c={birthcertno:{value:"T1669632Z"},name:{value:"Middle Tan Twin2"},dob:{value:i(n().subtract(2,"years"))}},l={birthcertno:{value:"T1509027D"},name:{value:"Tan Boy"},dob:{value:i(n().subtract(3,"years"))}},d={birthcertno:{value:"T1422931G"},name:{value:"Tan Girl"},dob:{value:i(n().subtract(4,"years"))}},f={birthcertno:{value:"T1511326F"},name:{value:"Tan Girl Younger"},dob:{value:i(n().subtract(5,"years"))}},p={birthcertno:{value:"T0050832I"},name:{value:"Super Old Tan Ke Wei"},dob:{value:i(n().subtract(8,"years"))}},y={birthcertno:{value:"T1364674G"},name:{value:"Turning 6 Tan Kid born Jan 1st"},dob:{value:i(n().subtract(6,"years").startOf("year"))}},h={birthcertno:{value:"T1210114C"},name:{value:"Turning 7 Tan Kid born Dec 31"},dob:{value:i(n().subtract(7,"years").endOf("year"))}};t.ChildrenRecords={childYoungest:a,child1MonthOld:o,child2MonthsOld:s,childMiddle1:u,childMiddle2:c,childMiddle3:l,childMiddle4:d,childMiddle5:f,childSuperOld:p,child6YearsOld:y,child7YearsOld:h}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(18),o=r(6),s=r(9),u=function(){function e(e){this.axiosClient=s.createClient({timeout:1e4}),this.appId=e.appId,this.privateKeyContent=e.privateKeyToSignRequest,this.privateKeyPassword=e.privateKeyPassword}return e.prototype.get=function(e,t){return n(this,void 0,void 0,function(){var r,n,s,u;return i(this,function(i){switch(i.label){case 0:return"",n=a()(),s=(new Date).getTime(),r=o.SigningUtil.generateMyInfoAuthorizationHeader(e,t,o.SigningUtil.HttpMethod.GET,this.appId,this.privateKeyContent,n,s,this.privateKeyPassword),u={params:t,headers:{Authorization:r}},[4,this.axiosClient.get(e,u)];case 1:return[2,i.sent()]}})})},e}();t.MyInfoRequest=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19);t.ConfigUtils=n;var i=r(20);t.StringUtil=i;var a=r(22);t.JestUtil=a;var o=r(23);t.SigningUtil=o;var s=r(8);t.JweUtil=s},function(e,t){e.exports=require("querystring")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(25);t.decryptJWE=function(e,t){return n(this,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:if(!e)throw new Error("Missing JWE data.");if(!t)throw new Error("Missing key to decrypt JWE payload.");return[4,a.JWK.asKey(t,"pem")];case 1:return r=n.sent(),[2,a.JWE.createDecrypt(r,{algorithms:["*"]}).decrypt(e)]}})})},t.verifyJWS=function(e,t){return n(this,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:if(!e)throw new Error("Missing JWS data.");if(!t)throw new Error("Missing cert to verify JWS payload.");return[4,a.JWK.asKey(t,"pem")];case 1:return r=n.sent(),[2,a.JWS.createVerify(r).verify(e)]}})})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=r(26),a=r(27),o=r(28);t.createClient=function(e){void 0===e&&(e={});var t=s();e=t?n({proxy:t},e):e;var r=i.default.create(n({},e));return u(r),c(r),r};var s=function(){var e=process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy;if(e){var t=a.parse(e),r=t.auth.split(":"),n=r[0],i=r[1];return{host:t.hostname,port:parseInt(t.port,10),auth:{username:n,password:i}}}return null},u=function(e){e.interceptors.request.use(function(e){return e&&l("Requesting "+e.method+" : "+o.redactNricfinInString(e.url)),e},function(e){return l("Error occurred while making a request "+e.message,e),Promise.reject(e)})},c=function(e){e.interceptors.response.use(function(e){return e&&l("Responded "+e.config.method+"  : "+o.redactNricfinInString(e.config.url)),e},function(e){return e.response?l("Error occurred while responding to request "+e.response.config.method+" :\n\t\t\t"+o.redactNricfinInString(e.response.config.url),e):l("Error occurred while responding to request",e),Promise.reject(e)})},l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.log(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31),i=r(32),a=r(33),o=r(34),s=r(35),u=r(36),c=r(37),l=r(38),d=r(39),f=r(2),p=r(40),y=r(41),h=r(42);t.profiles=[f.mrSGDaddyPerfect,y.mrsSGMommyPerfect,n.mrPRDaddyPerfect,p.mrsMYMommyPerfect,a.mrSGDaddyChildNone,d.mrPRDaddyOneChild,i.mrSGDaddyChildIsOld,s.mrSGDaddyManyChildren,u.mrPreschoolRegister,o.mrSGDaddyLongNames,c.mrSGDaddyMissingFields,l.mrSGDaddyMissingUneditableFields,h.mrMYDaddyPerfect]},function(e,t){e.exports=require("moment")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unavailableField={lastupdated:"2018-05-10",source:"1",classification:"C",unavailable:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(43);t.domain=n;var i=r(3);t.domainMap=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15);t.MyInfo=n;var i=r(45);t.Singpass=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16);t.Helper=n.MyInfoHelper,t.Request=n.MyInfoRequest;var i=r(29);t.Fake=i,function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(13))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(17)),n(r(5))},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(5),s=r(8),u=function(){return function(e){var t=this;if(this.getPersonBasic=function(e){return n(t,void 0,void 0,function(){var t,r,n,a,o,u,c,l,d,f;return i(this,function(i){switch(i.label){case 0:t=this.personBasicURL+"/"+e,r={client_id:this.clientID,sp_esvcId:this.singpassEserviceID,attributes:this.attributes.join(",")},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.myInfoRequest.get(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw a=i.sent(),console.error("Error requesting for person data (JWE) from MyInfo",a),a;case 4:return i.trys.push([4,7,,8]),o=n.data,[4,s.decryptJWE(o,this.keyToDecryptJWE)];case 5:return u=i.sent(),c=JSON.parse(u.payload.toString()),[4,s.verifyJWS(c,this.certToVerifyJWS)];case 6:if(l=i.sent(),null==(d=JSON.parse(l.payload.toString())))throw new Error("Person data cannot be null");return[2,d];case 7:throw f=i.sent(),console.error("Error verifying person data from MyInfo",f),f;case 8:return[2]}})})},a.isEmpty(e.attributes))throw new Error("Attribute list must contain values");this.attributes=e.attributes,this.clientID=e.clientID,this.personBasicURL=e.personBasicURL,this.singpassEserviceID=e.singpassEserviceID,this.keyToDecryptJWE=e.keyToDecryptJWE,this.certToVerifyJWS=e.certToVerifyJWS;var r={appId:e.clientID,privateKeyToSignRequest:e.privateKeyToSignRequest,privateKeyPassword:e.privateKeyPassword};this.myInfoRequest=new o.MyInfoRequest(r)}}();t.MyInfoHelper=u},function(e,t){e.exports=require("nonce")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!0;function i(e,t){var r=process.env[e]?process.env[e].trim():t;return!r&&n&&console.warn("Configuration key not found or empty: "+e),r}t.disableMissingEnvWarnings=function(){n=!1},t.getValueFromEnv=i,t.getValueFromEnvWithoutWarn=function(e,t){return process.env[e]?process.env[e].trim():t},t.getIntValueFromEnv=function(e,t){var r=i(e,null);if(!r)return t;var a=parseInt(r,10);return isNaN(a)?(n&&console.warn("Configuration "+e+" is not a valid integer: "+r),t):a},t.getBooleanValueFromEnv=function(e,t){void 0===t&&(t=!1);var r=i(e,null);return r?("true"!==r&&"false"!==r&&console.warn("Configuration "+e+" is not a valid boolean: "+r),"true"===r):t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(21);t.replaceLineBreaks=function(e){return e?e.replace(/\\n/g,"\n"):e},t.isBase64Valid=function(e){return n(e,{paddingRequired:!1})}},function(e,t){e.exports=require("is-base64")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTest=function(){return global.describe&&global.it}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(7),a=r(24);!function(e){e.GET="GET",e.POST="POST"}(t.HttpMethod||(t.HttpMethod={})),t.generateMyInfoAuthorizationHeader=function(e,t,r,o,s,u,c,l){return function(e,t,r,n){return'PKI_SIGN app_id="'+e+'",nonce="'+t+'",signature_method="RS256",signature="'+r+'",timestamp="'+n+'"'}(o,u,function(e,t,r,o,s,u){var c=n.merge(e,t),l=["app_id","attributes","client_id","nonce","signature_method","sp_esvcId","timestamp"].reduce(function(e,t){return n.set(e,t,c[t])},{}),d=i.unescape(i.stringify(l)),f=r.toUpperCase()+"&"+o+"&"+d,p={key:s};return u&&n.set(p,"passphrase",u),a.createSign("RSA-SHA256").update(f).sign(p,"base64")}({app_id:o,nonce:u,signature_method:"RS256",timestamp:c},t,r,e,s,l),c)}},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("node-jose")},function(e,t){e.exports=require("axios-https-proxy-fix")},function(e,t){e.exports=require("url")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redactNricfinInString=function(e){var r=i(e);if(-1!==r){var n=e.substr(r,9),a=t.redactNricfin(n);return e.replace(n,a)}return e},t.redactNricfin=function(e){if(e&&n(e)){var t=e.substring(1,4);return e.replace(t,"***")}return e};var n=function(e){return/[STFG]\d{7}[A-Z]/i.exec(e)},i=function(e){var t=/[STFG]\d{7}[A-Z]/i.exec(e);return t?t.index:-1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30);t.Helper=n.FakeMyInfoHelper;var i=r(44);t.Request=i.FakeMyInfoRequest,function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(10));var a=r(1);t.ProfileArchetype=a.ProfileArchetype},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=r(10),a=r(13),o=r(0),s=function(){return function(e){var t=this;this.attributes=e,this.getPersonBasic=function(e){var r=i.profiles.find(function(t){return t.name===e.archetype});if(!r)return null;var s,u,c,l=n({},r.generate());return o.isEmpty(e.marital)||(l.marital.desc=e.marital,l.marital.code=a.domainMap.sex.map.descToCode[e.marital]),o.isEmpty(e.marriagedate)||(l.marriagedate.value=e.marriagedate),o.isEmpty(e.marriagecertno)||(l.marriagecertno.value=e.marriagecertno),o.isEmpty(e.countryofmarriage)||(l.countryofmarriage.desc=e.countryofmarriage.desc,l.countryofmarriage.code=e.countryofmarriage.code),o.isEmpty(e.dob)||(l.dob.value=e.dob),o.isEmpty(e.occupation)?o.isEmpty(e.occupationfreeform)||(l.occupation.value="",l.occupation.desc=e.occupationfreeform):l.occupation.value=e.occupation,t.attributes?(s=l,u=t.attributes,c=new Set(u),o.toPairs(s).filter(function(e){var t=e[0];return c.has(t)}).reduce(function(e,t){var r,i=t[0],a=t[1];return n({},e,((r={})[i]=a,r))},{})):l}}}();t.FakeMyInfoHelper=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(3),s=i.ProfileArchetype.MR_PR_DADDY_PERFECT;t.mrPRDaddyPerfect={id:"S2599302J",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.nationality.code="AD",t.residentialstatus.code="P",t.residentialstatus.desc=o.residentialstatus.map.codeToDesc[t.residentialstatus.code],t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(4),s=i.ProfileArchetype.MR_SG_DADDY_CHILD_IS_OLD;t.mrSGDaddyChildIsOld={id:"T2446959F",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.childrenbirthrecords=[o.ChildrenRecords.childSuperOld],t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=i.ProfileArchetype.MR_SG_DADDY_CHILD_NONE;t.mrSGDaddyChildNone={id:"T2446959F",name:o,generate:function(e){e=n.isEmpty(e)?o:e;var t=a.mrSGDaddyPerfect.generate(e);return t.childrenbirthrecords=[],t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(4),s=i.ProfileArchetype.MR_SG_DADDY_LONG_NAMES;t.mrSGDaddyLongNames={id:"T2446959F",name:s,generate:function(e){var t="Princess Aura Nurr Ermily Amara Auliya Bidadari S/O (Nawal), El@Björk' María-Jose!";e=n.isEmpty(e)?t:e;var r=a.mrSGDaddyPerfect.generate(e);return r.childrenbirthrecords=n.values(o.ChildrenRecords),r.childrenbirthrecords[0].name.value=t+" JR",r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(4),s=i.ProfileArchetype.MR_SG_DADDY_MANY_CHILDREN;t.mrSGDaddyManyChildren={id:"T2446959F",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.childrenbirthrecords=n.values(o.ChildrenRecords),t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(11),a=r(1),o=r(2),s=a.ProfileArchetype.MR_SG_PRESCHOOL_CHILDREN;t.mrPreschoolRegister={id:"S0350934F",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var r=o.mrSGDaddyPerfect.generate(e);return r.childrenbirthrecords=n.values(t.ChildrenRecords),r}};var u=function(e){return e?e.format("YYYY-MM-DD").toString():i().format("YYYY-MM-DD").toString()},c={birthcertno:{value:"T1639540J"},name:{value:"Child w level not offered"},dob:{value:u(i().subtract(2,"years"))}},l={birthcertno:{value:"T1717003H"},name:{value:"Child w ineligible"},dob:{value:u(i().subtract(2,"years"))}},d={birthcertno:{value:"T1728256A"},name:{value:"Child w registered"},dob:{value:u(i().subtract(3,"years"))}},f={birthcertno:{value:"T1766863Z"},name:{value:"Child w nothing"},dob:{value:u(i().subtract(4,"years"))}},p={birthcertno:{value:"T1783246D"},name:{value:"Child2 w level not offered "},dob:{value:u(i().subtract(5,"years"))}},y={birthcertno:{value:"T1790160A"},name:{value:"Child2 w ineligible"},dob:{value:u(i().subtract(6,"years"))}};t.ChildrenRecords={c1:c,c2:l,c3:d,c4:f,c5:p,c6:y}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(12),s=i.ProfileArchetype.MR_SG_DADDY_MISSING_FIELDS;t.mrSGDaddyMissingFields={id:"S8779834H",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.hanyupinyinname=o.unavailableField,t.aliasname=o.unavailableField,t.hanyupinyinaliasname=o.unavailableField,t.secondaryrace=o.unavailableField,t.residentialstatus=o.unavailableField,t.homeno=o.unavailableField,t.marriagecertno=o.unavailableField,t.countryofmarriage=o.unavailableField,t.childrenbirthrecords&&(t.childrenbirthrecords=t.childrenbirthrecords.slice(0,1)),t.edulevel=o.unavailableField,t.occupation=o.unavailableField,t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(12),s=i.ProfileArchetype.MR_SG_DADDY_MISSING_UNEDITABLE_FIELDS;t.mrSGDaddyMissingUneditableFields={id:"S8974352D",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.nationality=o.unavailableField,t.dob=o.unavailableField,t.regadd=o.unavailableField,t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(4),s=r(3),u=i.ProfileArchetype.MR_PR_DADDY_ONE_CHILD;t.mrPRDaddyOneChild={id:"S7936715Z",name:u,generate:function(e){e=n.isEmpty(e)?u:e;var t=a.mrSGDaddyPerfect.generate(e);return t.residentialstatus.code="P",t.residentialstatus.desc=s.residentialstatus.map.codeToDesc[t.residentialstatus.code],t.childrenbirthrecords=[o.ChildrenRecords.childYoungest],t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(3),s=i.ProfileArchetype.MRS_MY_MOMMY_PERFECT;t.mrsMYMommyPerfect={id:"F5994458N",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.sex.code="F",t.sex.desc=o.sex.map.codeToDesc[t.sex.code],t.nationality.code="MY",t.birthcountry.code="MY",t.residentialstatus.code="A",t.residentialstatus.desc=o.residentialstatus.map.codeToDesc[t.residentialstatus.code],t.passportnumber.value="A00000000",t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(3),s=i.ProfileArchetype.MRS_SG_MOMMY_PERFECT;t.mrsSGMommyPerfect={id:"T2446959F",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.sex.code="F",t.sex.desc=o.sex.map.codeToDesc[t.sex.code],t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(2),o=r(3),s=i.ProfileArchetype.MR_MY_DADDY_PERFECT;t.mrMYDaddyPerfect={id:"F5994458N",name:s,generate:function(e){e=n.isEmpty(e)?s:e;var t=a.mrSGDaddyPerfect.generate(e);return t.sex.code="M",t.sex.desc=o.sex.map.codeToDesc[t.residentialstatus.code],t.nationality.code="MY",t.birthcountry.code="MY",t.residentialstatus.code="A",t.residentialstatus.desc=o.residentialstatus.map.codeToDesc[t.residentialstatus.code],t.passportnumber.value="A00000000",t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.get=function(e){return n(this,void 0,void 0,function(){return i(this,function(t){return[2,e]})})},e.prototype.postForm=function(e){return n(this,void 0,void 0,function(){return i(this,function(t){return[2,e]})})},e}();t.FakeMyInfoRequest=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(46))},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o,s,u=r(7),c=r(9),l=r(6);!function(e){e.SUCCESS="SUCCESS",e.SINGPASS_ERROR="SINGPASS_ERROR",e.INVALID_SESSION_ID="INVALID_SESSION_ID"}(o=t.SessionRefreshResult||(t.SessionRefreshResult={})),function(e){e.SUCCESS="SUCCESS",e.SINGPASS_ERROR="SINGPASS_ERROR"}(s=t.SessionLogoutResult||(t.SessionLogoutResult={}));var d=function(){function e(e){var t=this;this.SINGPASS_SESSION_COOKIE_NAME="PD-S-SESSION-ID",this.axiosClient=c.createClient({timeout:1e4}),this.constructAuthorizationUrl=function(e,r){var i=n({state:e},r?{nonce:r}:{},{redirect_uri:t.redirectUri,scope:"openid",client_id:t.clientID,response_type:"code"}),a=u.stringify(i);return t.authorizationUrl+"?"+a},this.getTokens=function(e,r){return i(t,void 0,void 0,function(){var t,i,o,s;return a(this,function(a){switch(a.label){case 0:return t={grant_type:"authorization_code",code:e,client_id:this.clientID,client_secret:this.clientSecret,redirect_uri:this.redirectUri},i=u.stringify(t),o=n({headers:{"content-type":"application/x-www-form-urlencoded"}},r),[4,this.axiosClient.post(this.tokenUrl,i,o)];case 1:if(!(s=a.sent()).data.id_token)throw console.error("Failed to get ID token: invalid response data",s.data),new Error("Failed to get ID token");return[2,s.data]}})})},this._testExports={singpassClient:this.axiosClient},this.authorizationUrl=e.authorizationUrl,this.logoutUrl=e.logoutUrl,this.tokenUrl=e.tokenUrl,this.clientID=e.clientID,this.clientSecret=e.clientSecret,this.redirectUri=e.redirectUri,this.jweDecryptKey=e.jweDecryptKey,this.jwsVerifyKey=e.jwsVerifyKey}return e.prototype.getIdTokenPayload=function(e){return i(this,void 0,void 0,function(){var t,r,n,i,o;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t=e.id_token,[4,l.JweUtil.decryptJWE(t,this.jweDecryptKey)];case 1:return r=a.sent(),n=r.payload.toString(),[4,l.JweUtil.verifyJWS(n,this.jwsVerifyKey)];case 2:return i=a.sent(),[2,JSON.parse(i.payload.toString())];case 3:throw o=a.sent(),console.error("Failed to get token payload",o),o;case 4:return[2]}})})},e.prototype.extractNricAndUuidFromPayload=function(e){var t=e.sub;if(t){var r=t.match(/s=([STFG]\d{7}[A-Z]).*,u=(.*)/i);if(!r)throw Error("Token payload sub property is invalid, does not contain valid NRIC and uuid string");return{nric:r[1],uuid:r[2]}}throw Error("Token payload sub property is not defined")},e.prototype.refreshSession=function(e,t){return void 0===t&&(t="dummyState"),i(this,void 0,void 0,function(){var r,n,i;return a(this,function(a){switch(a.label){case 0:r=this.constructAuthorizationUrl(t),n={headers:{Cookie:this.SINGPASS_SESSION_COOKIE_NAME+"="+e}},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.axiosClient.get(r,n)];case 2:return a.sent().request.res.responseUrl.includes("saml.singpass.gov.sg")?(console.warn("Attempted to refresh session with invalid session ID "+e),[2,o.INVALID_SESSION_ID]):[2,o.SUCCESS];case 3:return i=a.sent(),console.warn("Singpass Error while attempting to refresh session for sessionId: "+e+"\nError:",i),[2,o.SINGPASS_ERROR];case 4:return[2]}})})},e.prototype.logoutOfSession=function(e){return i(this,void 0,void 0,function(){var t,r;return a(this,function(n){switch(n.label){case 0:t={headers:{Cookie:this.SINGPASS_SESSION_COOKIE_NAME+"="+e}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.axiosClient.get(this.logoutUrl,t)];case 2:return n.sent(),[2,s.SUCCESS];case 3:return r=n.sent(),console.warn("Singpass Error while attempting to logout of Singpass session",r),[2,s.SINGPASS_ERROR];case 4:return[2]}})})},e}();t.OidcHelper=d}]);
//# sourceMappingURL=index.js.map